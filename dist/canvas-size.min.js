/*!
 * canvas-size
 * v1.1.0
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2020 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).canvasSize=t()}(this,(function(){"use strict";function e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function t(){return(t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?n(Object(o),!0).forEach((function(n){e(t,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):n(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function o(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e){var t,n,r=e.sizes.shift(),o=r[0],i=r[1],a=[o-1,i-1,1,1],s=Date.now(),c="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope;c?(t=new OffscreenCanvas(1,1),n=new OffscreenCanvas(o,i)):((t=document.createElement("canvas")).width=1,t.height=1,(n=document.createElement("canvas")).width=o,n.height=i);var f=t.getContext("2d"),h=n.getContext("2d");h&&(h.fillRect.apply(h,a),f.drawImage(n,o-1,o-1,1,1,0,0,1,1));var l=f&&0!==f.getImageData(0,0,1,1).data[3],p=Date.now()-s;return c?(postMessage({width:o,height:i,benchmark:p,isTestPass:l}),!l&&e.sizes.length&&u(e)):l?e.onSuccess(o,i,p):(e.onError(o,i,p),e.sizes.length&&u(e)),l}var f={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},h={area:[32767,16384,14188,11402,10836,11180,8192,4096,f.min],height:[8388607,65535,32767,16384,8192,4096,f.min],width:[4194303,65535,32767,16384,8192,4096,f.min]},l={};function p(e){var t=e.width===e.height,n=1===e.height,r=1===e.width,o=[];if(e.width&&e.height)for(var i=e.min||f.min,a=e.step||f.step,s=Math.max(e.width,e.height);s>=i;){var c=t||n?s:1,u=t||r?s:1;o.push([c,u]),s-=a}else e.sizes.forEach((function(e){var i=t||n?e:1,a=t||r?e:1;o.push([i,a])}));return o}function d(e){var t=window&&"HTMLCanvasElement"in window,n=window&&"OffscreenCanvas"in window,a=Date.now(),s=e.onError,c=e.onSuccess,f=o(e,["onError","onSuccess"]),h=null;if(!t)return!1;if(e.useWorker&&n){var p="\n            ".concat(u.toString(),"\n            onmessage = function(e) {\n                canvasTest(e.data);\n            };\n        "),d=new Blob([p],{type:"application/javascript"}),m=URL.createObjectURL(d);h=new Worker(m),URL.revokeObjectURL(m),h.onmessage=function(e){var t=e.data,n=t.width,r=t.height,o=t.benchmark;t.isTestPass?(l[a].onSuccess(n,r,o),delete l[a]):l[a].onError(n,r,o)}}return e.usePromise?new Promise((function(t,n){var o=r(r({},e),{},{onError:function(t,r,o){var a;if(0===e.sizes.length)a=!0;else{var c=i(e.sizes.slice(-1),1),u=i(c[0],2),f=u[0],h=u[1];a=t===f&&r===h}s(t,r,o),a&&n({width:t,height:r,benchmark:o})},onSuccess:function(e,n,r){c(e,n,r),t({width:e,height:n,benchmark:r})}});if(h){var p=o.onError,d=o.onSuccess;l[a]={onError:p,onSuccess:d},h.postMessage(f)}else u(o)})):h?(l[a]={onError:s,onSuccess:c},void h.postMessage(f)):u(e)}return{maxArea:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=p({width:e.max,height:e.max,min:e.min,step:e.step,sizes:a(h.area)}),r=t({},f,e,{sizes:n});return d(r)},maxHeight:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=p({width:1,height:e.max,min:e.min,step:e.step,sizes:a(h.height)}),r=t({},f,e,{sizes:n});return d(r)},maxWidth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=p({width:e.max,height:1,min:e.min,step:e.step,sizes:a(h.width)}),r=t({},f,e,{sizes:n});return d(r)},test:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t({},f,e);return n.sizes=a(n.sizes),n.width&&n.height&&(n.sizes=[[n.width,n.height]]),d(n)}}}));
//# sourceMappingURL=canvas-size.min.js.map
