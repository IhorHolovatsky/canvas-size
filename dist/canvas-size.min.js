/*!
 * canvas-size
 * v1.1.0
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2020 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).canvasSize=t()}(this,(function(){"use strict";function e(){return(e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function t(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function n(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e){var t,n,r=e.sizes.shift(),o=r[0],s=r[1],a=[o-1,s-1,1,1],c=Date.now(),u="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope;u?(t=new OffscreenCanvas(1,1),n=new OffscreenCanvas(o,s)):((t=document.createElement("canvas")).width=1,t.height=1,(n=document.createElement("canvas")).width=o,n.height=s);var h=t.getContext("2d"),f=n.getContext("2d");f.fillRect.apply(f,a),h.drawImage(n,o-1,o-1,1,1,0,0,1,1);var l=0!==h.getImageData(0,0,1,1).data[3],d=Date.now()-c;return u?(postMessage({width:o,height:s,benchmark:d,isTestPass:l}),!l&&e.sizes.length&&i(e)):l?e.onSuccess(o,s,d):(e.onError(o,s,d),e.sizes.length&&i(e)),l}var o={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},s={area:[32767,16384,14188,11402,10836,11180,8192,4096,o.min],height:[8388607,65535,32767,16384,8192,4096,o.min],width:[4194303,65535,32767,16384,8192,4096,o.min]},a={};function c(e){var t=e.width===e.height,n=1===e.height,r=1===e.width,i=[];if(e.width&&e.height)for(var s=e.min||o.min,a=e.step||o.step,c=Math.max(e.width,e.height);c>=s;){var u=t||n?c:1,h=t||r?c:1;i.push([u,h]),c-=a}else e.sizes.forEach((function(e){var o=t||n?e:1,s=t||r?e:1;i.push([o,s])}));return i}function u(n){var r=window&&window.HTMLCanvasElement,o=Date.now();if(!r)return!1;if(!(n.useWorker&&window&&"OffscreenCanvas"in window))return n.usePromise?new Promise((function(t,r){i(e({},n,{onError:function(e,t,i){n.onError&&n.onError(e,t,i),0===n.sizes.length&&r({width:e,height:t,benchmark:i})},onSuccess:function(e,r,i){n.onSuccess&&n.onSuccess(e,r,i),t({width:e,height:r,benchmark:i})}}))})):i(n);var s="\n            ".concat(i.toString(),"\n            onmessage = function(e) {\n                canvasTest(e.data);\n            };\n        "),c=new Blob([s],{type:"application/javascript"}),u=URL.createObjectURL(c),h=new Worker(u),f=n.onError,l=n.onSuccess,d=t(n,["onError","onSuccess"]);URL.revokeObjectURL(u),a[o]={onError:f,onSuccess:l},h.onmessage=function(e){var t=e.data,n=t.width,r=t.height,i=t.benchmark;t.isTestPass?(a[o].onSuccess(n,r,i),delete a[o]):a[o].onError(n,r,i)},h.postMessage(d)}return{maxArea:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=c({width:t.max,height:t.max,min:t.min,step:t.step,sizes:n(s.area)}),i=e({},o,t,{sizes:r});return u(i)},maxHeight:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=c({width:1,height:t.max,min:t.min,step:t.step,sizes:n(s.height)}),i=e({},o,t,{sizes:r});return u(i)},maxWidth:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=c({width:t.max,height:1,min:t.min,step:t.step,sizes:n(s.width)}),i=e({},o,t,{sizes:r});return u(i)},test:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e({},o,t);return r.sizes=n(r.sizes),r.width&&r.height&&(r.sizes=[[r.width,r.height]]),u(r)}}}));
//# sourceMappingURL=canvas-size.min.js.map
